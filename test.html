<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script type="text/javascript">
  function insert(comp, start = 0, end) {
    let arr = this,
      len = end || arr.length,
      left,
      right,
      i,
      j,
      tempItem,
      temp,
      mid;
    for (i = start + 1; i < len; ++i) {
      tempItem = arr[i];
      left = start;
      if(comp(tempItem, arr[i-1]) < 0){
        right = i - 1;
        while (left <= right) {
          mid = Math.floor((left + right) / 2);
          temp = comp(tempItem, arr[mid]);
          if (temp < 0) {
            right = mid - 1;
          } else {
            left = mid + 1;
          }
        }
        for (j = i - 1; j >= left; --j) {
          arr[j + 1] = arr[j];
        }
        arr[left] = tempItem;
      }
    }
    return arr;
  };

  function merge(arr, comp) {
    let len = arr.length,
      i,
      j,
      _len = Math.pow(2, Math.ceil(Math.log2(len)));
    for(i = 2; i <= _len; i = i << 1){
      for(j = 0; j < len; j += i){
        insert.call(arr, comp, j, Math.min(j + i, len));
      }
    }
    return arr;
  };

  var z = [0,1,3,3,3,3,3,3,3,999,-10,4,5,6,7,9]
  //var z = [1, 999, -10, 7, 9]
  /*var r = merge.call(z, function (a, b) {
    return -(a - b)
  })*/
  var r = merge(z, function (a, b) {
    return b - a
  })
  console.log(r)
</script>
</body>
</html>
